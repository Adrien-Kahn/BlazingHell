(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,n){e.exports=n(129)},129:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(14),l=n.n(c),i=(n(121),n(17)),s=n(15),u=n(19),m=n(18),d=n(189),p=n(16),f=n(97),b=n(48),g=n(13),h=n.n(g),v=n(6),E=n(21),y=n(170),j=n(198),k=n(100),O=n(191),C=n(188),x=window.location.origin,S=function(){var e=Object(E.a)(h.a.mark((function e(t,n){var a,r,o,c,l,i,s,u,m,d,p;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new URL(t,x),r=0,o=Object.entries(n);r<o.length;r++)c=Object(v.a)(o[r],2),l=c[0],i=c[1],a.searchParams.set(l,i);return e.next=4,fetch(a.toString());case 4:return s=e.sent,e.next=7,s.json();case 7:if(u=e.sent,m=u.result,d=u.msg,p=u.data,m){e.next=11;break}throw Error(d);case 11:return e.abrupt("return",p);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function N(e){return e.state!==a.Infeasible&&e.state!==a.PendingResources}!function(e){e.Infeasible="INFEASIBLE",e.PendingResources="PENDING_RESOURCES",e.DependenciesUnready="PENDING",e.PendingCreation="CREATING",e.Alive="ALIVE",e.Restarting="RESTARTING",e.Dead="DEAD"}(a||(a={}));var w,T=function(e,t){return S("/node_errors",{nodeIp:e,pid:null!==t&&void 0!==t?t:""})},F=function(e,t){return S("/node_logs",{ip:e,pid:null!==t&&void 0!==t?t:""})},R=function(e,t,n){return S("/api/launch_profiling",{node_id:e,pid:t,duration:n})},I=function(e){return"".concat(x,"/speedscope/index.html#profileURL=").concat(encodeURIComponent("".concat(x,"/api/get_profiling_info?profiling_id=").concat(e)))},A=function(){return S("/tune/info",{})},L=function(e){return S("/tune/set_experiment",{experiment:e})},M=function(){return S("/tune/enable_tensorboard",{})},D=function(){var e=Object(E.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S("/memory/memory_table",{groupBy:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){return S("/memory/set_fetch",{shouldFetch:e})},W=n(4),B=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.lastUpdatedAt,a=e.error;return o.a.createElement("div",{className:t.root},null!==n&&o.a.createElement(k.a,{className:t.lastUpdated},"Last updated: ",new Date(n).toLocaleString()),null!==a&&o.a.createElement(k.a,{className:t.error},a))}}]),n}(o.a.Component),U=Object(p.b)((function(e){return{lastUpdatedAt:e.dashboard.lastUpdatedAt,error:e.dashboard.error}}))(Object(W.a)((function(e){return Object(j.a)({root:{marginTop:e.spacing(2)},lastUpdated:{color:e.palette.text.secondary,fontSize:"0.8125rem",textAlign:"center"},error:{color:e.palette.error.main,fontSize:"0.8125rem",textAlign:"center"}})}))(B)),z=n(190),G=n(131),_=n(132),H=n(134),V=n(135),q=n(201),J=n(196),K=n(192),Y=function(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0},X=function(e,t,n){var a=n(e),r=n(t);return r<a?-1:r>a?1:0},Q=function(e,t){return function(n,a){return"desc"===e?X(n,a,t):-X(n,a,t)}},Z=function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))},$=n(28),ee=function(e){if(0===e.length)return 0;var t,n=0,a=0,r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,c=o.weight;n+=c*o.value,a+=c}}catch(l){r.e(l)}finally{r.f()}return n/a},te=function(e){return e.reduce((function(e,t){return e+t}),0)},ne=n(99),ae=n(175),re=n(171),oe=n(87),ce=n.n(oe),le=n(88),ie=n.n(le),se=function(e){var t=e.onClick;return o.a.createElement(ce.a,{onClick:t})},ue=function(e){var t=e.onClick;return o.a.createElement(ie.a,{onClick:t})},me=n(195),de=Object(y.a)({tooltipLabel:{textDecorationLine:"underline",textDecorationColor:"#a6c3e3",textDecorationThickness:"1px",textDecorationStyle:"dotted",cursor:"help"}}),pe=function(e){var t=e.label,n=e.datum,a=e.tooltip,r=de(),c=o.a.createElement(re.a,{container:!0,item:!0,xs:12},o.a.createElement(re.a,{item:!0,xs:6},o.a.createElement(z.a,{className:a&&r.tooltipLabel},t)),o.a.createElement(re.a,{item:!0,xs:6},o.a.createElement("span",null,n)));return a?o.a.createElement(me.a,{title:a},c):c},fe=n(8),be=n(54),ge=n(174),he=Object(y.a)((function(e){return Object(j.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,display:"flex",flexGrow:1},inner:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})})),ve=function(e){var t=e.percent,n=e.text,a=he(),r=Math.max(Math.min(t,100),0),c=[0,255,0],l=c,i=function(e,t,n){var a=Object(v.a)(e,3),r=a[0],o=a[1],c=a[2],l=Object(v.a)(t,3);return[r*(1-n)+l[0]*n,o*(1-n)+l[1]*n,c*(1-n)+l[2]*n]}(c,[255,0,0],r/100),s="\n    linear-gradient(\n      to right,\n      rgba(".concat(l.join(","),", ").concat(.2,") 0%,\n      rgba(").concat(i.join(","),", ").concat(.2,") ").concat(r,"%,\n      transparent ").concat(r,"%\n    )\n  ");return o.a.createElement("span",{className:a.root},o.a.createElement("span",{className:a.inner,style:{background:s,flexGrow:1}},o.a.createElement(k.a,{align:"center"},n)))},Ee=a.Alive,ye=a.Dead,je=a.PendingCreation,ke=a.Restarting,Oe=a.DependenciesUnready,Ce=a.Infeasible,xe=a.PendingResources,Se=Object(y.a)((function(e){return Object(j.a)({infeasible:{color:e.palette.error.light},pendingResources:{color:e.palette.warning.light},unknown:{color:e.palette.warning.light},creating:{color:e.palette.success.light},alive:{color:e.palette.success.dark},restarting:{color:e.palette.warning.light},dead:{color:"#cccccc"},tooltip:{cursor:"help"}})})),Ne=(w={},Object(fe.a)(w,Ee,"The actor is alive and handling remote calls."),Object(fe.a)(w,ye,"The actor is dead and will not be restarted anymore."),Object(fe.a)(w,Ce,"The actor cannot be created because of insufficient resources in the cluster. Please examine its resource constraints to make sure they are correct or add additional compute to your cluster."),Object(fe.a)(w,ke,"The actor died and is restarting."),Object(fe.a)(w,je,"The actor's resources and other dependencies are ready, and the Ray backend is processing its creation."),Object(fe.a)(w,Oe,"The actor is pending creation because it is waiting for one or more of its initialization arguments to be ready."),Object(fe.a)(w,xe,"The actor is pending resources, such as GPU, Memory, or CPU. It will be created when they become available."),w),we=function(e){var t,n=e.state,a=e.variant,r=e.showTooltip,c=Se(),l=null!==a&&void 0!==a?a:"body1";switch(n){case Ce:t=o.a.createElement(k.a,{variant:l,className:c.infeasible},"Infeasible");break;case xe:t=o.a.createElement(k.a,{variant:l,className:c.pendingResources},"Pending Resources");break;case je:t=o.a.createElement(k.a,{variant:l,className:c.creating},"Creating");break;case Oe:t=o.a.createElement(k.a,{variant:l,className:c.creating},"Dependencies Unready");break;case Ee:t=o.a.createElement(k.a,{variant:l,className:c.alive},"Alive");break;case ke:t=o.a.createElement(k.a,{variant:l,className:c.restarting},"Restarting");break;case ye:t=o.a.createElement(k.a,{variant:l,className:c.dead},"Dead")}return r?o.a.createElement(me.a,{className:c.tooltip,title:Ne[n]},t):t},Te="https://docs.ray.io/en/master/memory-management.html#debugging-using-ray-memory",Fe=Object(y.a)((function(e){return{divider:{width:"100%",margin:"0 auto"},actorTitleWrapper:{marginTop:e.spacing(1),marginBottom:e.spacing(1),fontWeight:"bold",fontSize:"130%"},detailsPane:{margin:e.spacing(1)}}})),Re=function(e){var t,n,a,r,c=e.actor,l=Fe(),i=function(e){var t,n,a,r,o,c,l,i,s,u;return N(e)?[{label:"Resources",value:e.usedResources&&Object.entries(e.usedResources).length>0&&Object.entries(e.usedResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1];return"".concat(te(a.resourceSlots.map((function(e){return e.allocation})))," ").concat(n)})).join(", ")},{label:"Number of pending tasks",value:null!==(t=null===(n=e.taskQueueLength)||void 0===n?void 0:n.toLocaleString())&&void 0!==t?t:"0",tooltip:"The number of tasks that are currently pending to execute on this actor. If this number remains consistently high, it may indicate that this actor is a bottleneck in your application."},{label:"Number of executed tasks",value:null!==(a=null===(r=e.numExecutedTasks)||void 0===r?void 0:r.toLocaleString())&&void 0!==a?a:"0",tooltip:"The number of tasks this actor has executed throughout its lifetimes."},{label:"Number of ObjectRefs in scope",value:null!==(o=null===(c=e.numObjectRefsInScope)||void 0===c?void 0:c.toLocaleString())&&void 0!==o?o:"0",tooltip:"The number of ObjectRefs that this actor is keeping in scope via its internal state. This does not imply that the objects are in active use or colocated on the node with the actor "+"currently. This can be useful for debugging memory leaks. See the docs at ".concat(Te," ")+"for more information."},{label:"Number of local objects",value:null!==(l=null===(i=e.numLocalObjects)||void 0===i?void 0:i.toLocaleString())&&void 0!==l?l:"0",tooltip:"The number of small objects that this actor has stored in its local in-process memory store. This can be useful for "+"debugging memory leaks. See the docs at ".concat(Te," for more information")},{label:"Object store memory used (MiB)",value:null!==(s=null===(u=e.usedObjectStoreMemory)||void 0===u?void 0:u.toLocaleString())&&void 0!==s?s:"0",tooltip:"The total amount of memory that this actor is occupying in the Ray object store. If this number is increasing without bounds, you might have a memory leak. See "+"the docs at: ".concat(Te," for more information.")}]:[{label:"Actor ID",value:e.actorId,tooltip:""},{label:"Required resources",value:e.requiredResources&&Object.entries(e.requiredResources).length>0&&Object.entries(e.requiredResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1];return"".concat(a.toLocaleString()," ").concat(n)})).join(", "),tooltip:""}]}(c);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:l.actorTitleWrapper},o.a.createElement("div",null,c.actorClass),o.a.createElement(we,{state:c.state})),N(c)&&o.a.createElement(re.a,{container:!0,spacing:3,className:l.detailsPane},o.a.createElement(re.a,{container:!0,item:!0,xs:6},o.a.createElement(re.a,{item:!0,xs:4},o.a.createElement(k.a,null,"CPU Usage")),o.a.createElement(re.a,{item:!0,xs:4},o.a.createElement(ve,{percent:null!==(t=null===(n=c.processStats)||void 0===n?void 0:n.cpuPercent)&&void 0!==t?t:0,text:"".concat(null!==(a=null===(r=c.processStats)||void 0===r?void 0:r.cpuPercent)&&void 0!==a?a:0,"%")})),o.a.createElement(re.a,{item:!0,xs:4})),c.gpus.length>0&&o.a.createElement(re.a,{container:!0,item:!0,xs:6},o.a.createElement(re.a,{item:!0,xs:12},o.a.createElement(k.a,null,"GPU Usage")),c.gpus.map((function(e){var t=e.utilizationGpu?o.a.createElement(ve,{percent:100*e.utilizationGpu,text:"".concat(100*e.utilizationGpu,"%")}):o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");return o.a.createElement(o.a.Fragment,{key:e.uuid},o.a.createElement(re.a,{item:!0,xs:4},"[".concat(e.name,"]")),o.a.createElement(re.a,{item:!0,xs:4},t),o.a.createElement(re.a,{item:!0,xs:4}))})))),o.a.createElement(ge.a,{className:l.divider}),o.a.createElement(re.a,{container:!0,className:l.detailsPane},i.map((function(e){var t=e.label,n=e.value,a=e.tooltip;return n&&n.length>0&&o.a.createElement(pe,{key:t,label:t,datum:n,tooltip:a})}))))},Ie=Object(y.a)((function(e){return Object(j.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,marginTop:e.spacing(2),padding:e.spacing(2),width:"100%"},title:{color:e.palette.text.secondary,fontSize:"0.75rem"},action:{color:e.palette.primary.main,textDecoration:"none","&:hover":{cursor:"pointer"}},infeasible:{color:e.palette.error.main},pendingResources:{color:e.palette.secondary.main},webuiDisplay:{fontSize:"0.875rem"},inlineHTML:{fontSize:"0.875rem",display:"inline"}})})),Ae=function(e){var t=e.actor,n=Object(r.useState)({}),c=Object(v.a)(n,2),l=c[0],i=c[1],s=Ie(),u=function(e){return Object(E.a)(h.a.mark((function n(){var r,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.state!==a.Alive){n.next=8;break}return n.next=3,R(t.nodeId,t.pid,e);case 3:return r=n.sent,i(Object(be.a)(Object(be.a)({},l),{},Object(fe.a)({},r,{startTime:Date.now(),latestResponse:null}))),o=function(){var e=Object(E.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/check_profiling_status",{profiling_id:r});case 2:t=e.sent,i(Object(be.a)(Object(be.a)({},l),{},Object(fe.a)({},r,Object(be.a)(Object(be.a)({},l[r]),{},{latestResponse:t})))),"pending"===t.status&&setTimeout(o,1e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.next=8,o();case 8:case"end":return n.stop()}}),n)})))},m=[];return N(t)&&t.webuiDisplay&&(m=Object.keys(t.webuiDisplay).sort().map((function(e,n,a){var r=t.webuiDisplay[e],c=JSON.parse(r),l=c.message;return"html"===c.dtype&&(l=o.a.createElement("div",{className:s.inlineHTML,dangerouslySetInnerHTML:{__html:l}})),""===e?o.a.createElement(k.a,{className:s.webuiDisplay},"\xa0 \xa0 ",l):o.a.createElement(k.a,{className:s.webuiDisplay},"\xa0 \xa0 ",e,": ",l)}))),o.a.createElement("div",{className:s.root},o.a.createElement(k.a,{className:s.title},N(t)?o.a.createElement(o.a.Fragment,null,"Actor ",t.actorId," (Profile for",[10,30,60].map((function(e){return o.a.createElement(o.a.Fragment,{key:e}," ",o.a.createElement("span",{className:s.action,onClick:u(e)},e,"s"))})),")"," ",t.state===a.Alive&&o.a.createElement("span",{className:s.action,onClick:function(){var e,n,r;t.state===a.Alive&&(e=t.actorId,n=t.ipAddress,r=t.port,S("/logical/kill_actor",{actorId:e,ipAddress:n,port:r}))}},"Kill Actor"),Object.entries(l).map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1],r=a.startTime,c=a.latestResponse;return null!==c&&o.a.createElement(o.a.Fragment,{key:n},"(","pending"===c.status?"Profiling for ".concat(Math.round((Date.now()-r)/1e3),"s..."):"finished"===c.status?o.a.createElement("a",{className:s.action,href:I(n),rel:"noopener noreferrer",target:"_blank"},"Profiling result"):"error"===c.status?"Profiling error: ".concat(c.error.trim()):void 0,")"," ")}))):t.state===a.Infeasible?o.a.createElement("span",{className:s.infeasible},t.actorClass," cannot be created because the Ray cluster cannot satisfy its resource requirements."):o.a.createElement("span",{className:s.pendingResources},t.actorClass," is pending until resources are available.")),o.a.createElement(Re,{actor:t}),N(t)&&o.a.createElement(o.a.Fragment,null,m.length>0&&o.a.createElement(o.a.Fragment,null,m)))},Le=function(e){return"".concat(e,"s")},Me=Object(ne.a)(z.a)({textAlign:"center"}),De=Object(y.a)((function(e){return Object(j.a)({container:{margin:e.spacing(1),padding:e.spacing(1),marginLeft:e.spacing(2)},title:{margin:e.spacing(1)},actorEntry:{width:"100%"}})})),Pe=function(e){var t=e.actorGroup,n=e.title,c=De(),l=Object(r.useState)(!1),i=Object(v.a)(l,2),s=i[0],u=i[1],m=function(){return u(!s)},d=t.entries.map((function(e,t){var n;return o.a.createElement(z.a,{component:"div",className:c.actorEntry,key:null!==(n=e.actorId)&&void 0!==n?n:t},o.a.createElement(Ae,{actor:e}))})),p=a.Alive,f=a.PendingResources,b=a.Infeasible,g=t.summary;return o.a.createElement(ae.a,{className:c.container},o.a.createElement(z.a,{display:"block",className:c.title},o.a.createElement(k.a,{variant:"h5"},n)),o.a.createElement(re.a,{container:!0,xs:12,spacing:2},o.a.createElement(re.a,{container:!0,item:!0,xs:5,className:c.title},b in g.stateToCount&&o.a.createElement(pe,{label:o.a.createElement(we,{state:b,variant:"body1",showTooltip:!0}),datum:g.stateToCount[b]}),o.a.createElement(pe,{label:o.a.createElement(we,{state:p,variant:"body1",showTooltip:!0}),datum:p in g.stateToCount?g.stateToCount[p]:0}),o.a.createElement(pe,{label:o.a.createElement(we,{state:f,variant:"body1",showTooltip:!0}),datum:f in g.stateToCount?g.stateToCount[f]:0})),o.a.createElement(re.a,{container:!0,item:!0,xs:5,className:c.title},o.a.createElement(pe,{label:"Mean Lifetime",datum:Le(g.avgLifetime)}),o.a.createElement(pe,{label:"Max Lifetime",datum:Le(g.maxLifetime)}),o.a.createElement(pe,{label:"Executed Tasks",datum:g.numExecutedTasks}))),s?o.a.createElement(o.a.Fragment,null,o.a.createElement(z.a,null,d),o.a.createElement(Me,null,o.a.createElement(se,{onClick:m}))):o.a.createElement(Me,null,o.a.createElement(ue,{onClick:m})))},We=function(e){var t=e.actorGroups,n=function(e){var t;return null!==(t=e.summary.stateToCount[a.Infeasible])&&void 0!==t?t:0},c=te(Object.values(t).map(n)),l=Object(r.useState)(c>0),i=Object(v.a)(l,2),s=i[0],u=i[1],m=Z(Object.entries(t),(function(e,t){var a=Object(v.a)(e,2),r=a[0],o=a[1],c=Object(v.a)(t,2),l=c[0],i=c[1],s=n(o),u=n(i);return s!==u?s>u?-1:1:r>l?1:-1})).map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1];return o.a.createElement(Pe,{actorGroup:a,title:n,key:"acg-".concat(n)})}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(J.a,{open:s},o.a.createElement(K.a,{severity:"warning",onClose:function(){return u(!1)}},"There are one or more actors that cannot currently be created due to insufficient cluster resources. These have been sorted to the top of the list. If you are using autoscaling functionality, you may ignore this message.")),m)},Be=Object(y.a)((function(e){return Object(j.a)({container:{marginBottom:e.spacing(1)}})})),Ue=function(e){return e.dashboard.actorGroups},ze=function(){var e=Object(r.useState)(""),t=Object(v.a)(e,2),n=t[0],a=t[1],c=Object(q.a)(n,500),l=Object(v.a)(c,1)[0],i=Be(),s=Object(p.d)(Ue);if(!s)return o.a.createElement(k.a,{color:"textSecondary"},"Loading...");if(0===Object.keys(s).length)return o.a.createElement(k.a,{color:"textSecondary"},"Finished loading, but have found no actors yet.");var u=""===l?Object.entries(s):Object.entries(s).filter((function(e){var t=Object(v.a)(e,2),n=t[0];t[1];return function(e,t){var n=t.toLowerCase();return-1!==e.toLowerCase().search(n)}(n,l)}));return o.a.createElement(z.a,{className:i.container},0===u.length?o.a.createElement(k.a,{color:"textSecondary"},"No actors found."):o.a.createElement(o.a.Fragment,null,o.a.createElement(G.a,null,o.a.createElement(_.a,{htmlFor:"actor-name-filter"},"Actor Search"),o.a.createElement(H.a,{id:"actor-name-filter","aria-describedby":"actor-name-helper-text",value:n,onChange:function(e){return a(e.target.value)}}),o.a.createElement(V.a,{id:"actor-name-helper-text"},"Search for an actor by name")),o.a.createElement(We,{actorGroups:Object.fromEntries(u)})))},Ge=n(182),_e=n(138),He=n(200),Ve=n(183),qe=n(92),Je=n.n(qe),Ke=n(91),Ye=n.n(Ke),Xe=n(90),Qe=n.n(Xe),Ze=n(70),$e=Object(Ze.b)({name:"dashboard",initialState:{actorGroups:null,tab:0,rayConfig:null,nodeInfo:null,tuneInfo:null,tuneAvailability:null,lastUpdatedAt:null,error:null,memoryTable:null,shouldObtainMemoryTable:!1},reducers:{setTab:function(e,t){e.tab=t.payload},setRayConfig:function(e,t){e.rayConfig=t.payload},setNodeInfo:function(e,t){e.nodeInfo=t.payload.nodeInfo,e.lastUpdatedAt=Date.now()},setActorGroups:function(e,t){e.actorGroups=t.payload.actorGroups},setTuneInfo:function(e,t){e.tuneInfo=t.payload.result,e.lastUpdatedAt=Date.now()},setTuneAvailability:function(e,t){e.tuneAvailability=t.payload.result,e.lastUpdatedAt=Date.now()},setError:function(e,t){e.error=t.payload},setMemoryTable:function(e,t){e.memoryTable=t.payload.memoryTable},setShouldObtainMemoryTable:function(e,t){e.shouldObtainMemoryTable=t.payload}}}),et=$e.actions,tt=$e.reducer,nt=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},at=function(e,t,n,a){var r=nt(e,n),o=nt(t,n),c=100*e/t,l="".concat(r," / ").concat(o);return a?"".concat(l," (").concat(c.toFixed(0),"%)"):l},rt=function(e){var t=Math.floor(e)%60,n=Math.floor(e/60)%60,a=Math.floor(e/60/60)%24,r=Math.floor(e/60/60/24),o=function(e){return e.toString().padStart(2,"0")};return[r?"".concat(r,"d"):"","".concat(o(a),"h"),"".concat(o(n),"m"),"".concat(o(t),"s")].join(" ")},ot=function(e){try{return(e.toString().split(".")[1].length||0)<=3?e.toString():Math.abs(e.valueOf())>=1?e.toPrecision(5):e.toExponential()}catch(t){return e.toString()}},ct=Object(y.a)((function(e){return Object(j.a)({expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},container:{padding:e.spacing(1),margin:e.spacing(1)}})})),lt=function(e){var t=e.memoryTableSummary,n=ct(),a=[["Total Local Reference Count","".concat(t.totalLocalRefCount)],["Pinned in Memory Count","".concat(t.totalPinnedInMemory)],["Total Used by Pending Tasks Count","".concat(t.totalUsedByPendingTask)],["Total Captured in Objects Count","".concat(t.totalCapturedInObjects)],["Total Memory Used by Objects","".concat(nt(t.totalObjectSize,"mebibyte"))],["Total Actor Handle Count","".concat(t.totalActorHandles)]];return o.a.createElement(re.a,{container:!0,className:n.container},a.map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1];return o.a.createElement(pe,{key:n,label:n,datum:a})})))},it=n(180),st=n(181),ut=n(178),mt=n(179),dt=n(199),pt=n(177),ft=Object(ne.a)(pt.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center"}})),bt=(Object(ne.a)(pt.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center",cursor:"pointer"}})),Object(y.a)((function(e){return Object(j.a)({visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}})}))),gt=function(e){var t=e.order,n=e.orderBy,a=e.onRequestSort,r=e.headerInfo,c=e.firstColumnEmpty,l=bt();return o.a.createElement(ut.a,null,o.a.createElement(mt.a,null,c&&o.a.createElement(ft,null),r.map((function(e){return e.sortable?o.a.createElement(ft,{key:e.label,align:e.numeric?"right":"left",sortDirection:n===e.id&&t},o.a.createElement(dt.a,{active:n===e.id,direction:n===e.id?t:"asc",onClick:(r=e.id,function(e){a(e,r)})},e.label,n===e.id?o.a.createElement("span",{className:l.visuallyHidden},"desc"===t?"sorted descending":"sorted ascending"):null)):o.a.createElement(ft,{key:e.label,align:e.numeric?"right":"left"},e.label);var r}))))},ht=function(e){var t=e.memoryTableEntry,n=-1===t.objectSize?"?":nt(t.objectSize,"mebibyte"),a=[t.nodeIpAddress,t.pid,t.type,t.objectRef,n,t.referenceType,t.callSite];return o.a.createElement(mt.a,{hover:!0},a.map((function(e,t){return o.a.createElement(ft,{key:"".concat(t)},e)})))},vt=Object(y.a)((function(e){return Object(j.a)({container:{margin:e.spacing(1),padding:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center"}})})),Et=[{id:"nodeIpAddress",label:"IP Address",numeric:!1,sortable:!0},{id:"pid",label:"PID",numeric:!1,sortable:!0},{id:"type",label:"Type",numeric:!1,sortable:!0},{id:"objectRef",label:"Object Ref",numeric:!1,sortable:!0},{id:"objectSize",label:"Object Size",numeric:!1,sortable:!0},{id:"referenceType",label:"Reference Type",numeric:!1,sortable:!0},{id:"callSite",label:"Call Site",numeric:!1,sortable:!0}],yt=function(e){var t=e.tableEntries,n=vt(),a=o.a.useState("asc"),r=Object(v.a)(a,2),c=r[0],l=r[1],i=o.a.useState(null),s=Object(v.a)(i,2),u=s[0],m=s[1],d=u&&function(e,t){return"desc"===e?function(e,n){return Y(e,n,t)}:function(e,n){return-Y(e,n,t)}}(c,u),p=(d?Z(t,d):t).map((function(e){return o.a.createElement(ht,{memoryTableEntry:e,key:e.objectRef})}));return o.a.createElement(ae.a,{className:n.container,elevation:2},o.a.createElement(it.a,null,o.a.createElement(gt,{orderBy:u,order:c,onRequestSort:function(e,t){t===u?l("asc"===c?"desc":"asc"):(m(t),l("asc"))},headerInfo:Et,firstColumnEmpty:!1}),o.a.createElement(st.a,null,p)))},jt=Object(ne.a)(z.a)({textAlign:"center"}),kt=Object(y.a)((function(e){return Object(j.a)({container:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}})})),Ot=function(e){var t=e.groupKey,n=e.groupTitle,a=e.entries,c=e.summary,l=e.initialExpanded,i=e.initialVisibleEntries,s=kt(),u=Object(r.useState)(l),m=Object(v.a)(u,2),d=m[0],p=m[1],f=Object(r.useState)(i),b=Object(v.a)(f,2),g=b[0],h=b[1],E=function(){return p(!d)},y=a.slice(0,g);return o.a.createElement(ae.a,{key:t,className:s.container},n,o.a.createElement(lt,{initialExpanded:!1,memoryTableSummary:c}),d?o.a.createElement(o.a.Fragment,null,o.a.createElement(yt,{tableEntries:y}),o.a.createElement(jt,null,a.length>g&&o.a.createElement(ue,{onClick:function(){return h(g+10)}}),o.a.createElement(se,{onClick:E}))):o.a.createElement(jt,null,o.a.createElement(ue,{onClick:E})))},Ct=function(e,t){return"node"===t?o.a.createElement(k.a,{variant:"h6"},"Node ".concat(e)):"stack_trace"===t?o.a.createElement(xt,{stackTrace:e}):""===t?o.a.createElement(k.a,{variant:"h6"},"All entries"):o.a.createElement(k.a,{variant:"h6"},"Unknown Group")},xt=function(e){var t=e.stackTrace.split(" | ").map((function(e,t){return o.a.createElement(k.a,{variant:0===t?"h6":"subtitle2",style:{marginLeft:"".concat(t,"em")},key:t},0!==t&&o.a.createElement(Qe.a,null),e)}));return o.a.createElement(z.a,null,t)},St=Object(y.a)((function(e){return Object(j.a)({pauseButton:{margin:e.spacing(1),padding:e.spacing(1),float:"right"},select:{minWidth:"7em"}})})),Nt=function(e){return e.dashboard.memoryTable},wt=function(e){return 0===Object.keys(e.group).length},Tt=function(e){return Math.abs(((new Date).getTime()-e.getTime())/1e3)>10},Ft=function(){var e=Object(p.d)(Nt),t=Object(p.c)(),n=new Date,a=Object(r.useState)(!1),c=Object(v.a)(a,2),l=c[0],i=c[1],s=l?o.a.createElement(Ye.a,null):o.a.createElement(Je.a,null),u=St(),m=Object(r.useState)("node"),d=Object(v.a)(m,2),f=d[0],b=d[1];Object(r.useEffect)((function(){return P(!0),function(){P(!1)}}),[]);var g,y,j=Object(r.useCallback)((g=f,y=function(e){return t(et.setMemoryTable(e))},Object(E.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(g);case 2:t=e.sent,y(t);case 4:case"end":return e.stop()}}),e)})))),[f]),O=Object(r.useRef)(null);if(Object(r.useEffect)((function(){O.current||l||(j(),O.current=setInterval(j,4e3));return function(){O.current&&(clearInterval(O.current),O.current=null)}}),[l,j,t]),!e||wt(e)&&!Tt(n))return o.a.createElement(k.a,{align:"center",color:"textSecondary",variant:"h3"},o.a.createElement(Ge.a,null)," Loading");if(wt(e)&&Tt(n))return o.a.createElement(k.a,{align:"center",color:"textSecondary",variant:"h3"},"Finished loading, but nothing found.");var C=Object.entries(e.group).sort((function(e,t){return Object(v.a)(e,1)[0]<Object(v.a)(t,1)[0]?-1:1})).map((function(e){var t=Object(v.a)(e,2),n=t[0],a=t[1];return o.a.createElement(Ot,{key:n,groupKey:n,groupTitle:Ct(n,f),entries:a.entries,summary:a.summary,initialExpanded:!1,initialVisibleEntries:10})}));return o.a.createElement(z.a,null,o.a.createElement(G.a,null,o.a.createElement(_.a,{shrink:!0,id:"group-by-label"},"Group by"),o.a.createElement(_e.a,{labelId:"group-by-label",value:f,className:u.select,onChange:function(e){return b(e.target.value)},color:"primary",displayEmpty:!0},o.a.createElement(He.a,{value:""},o.a.createElement("em",null,"None")),o.a.createElement(He.a,{value:"node"},"Node IP Address"),o.a.createElement(He.a,{value:"stack_trace"},"Stack Trace"))),o.a.createElement(Ve.a,{color:"primary",className:u.pauseButton,onClick:function(){O.current&&(clearInterval(O.current),O.current=null),P(!l),i(!l)}},s,l?"Resume Collection":"Pause Collection"),C)},Rt=n(184),It=n(193),At=n(12),Lt=n(197),Mt=n(176),Dt=n(93),Pt=n.n(Dt),Wt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.handleClose,a=e.title;return o.a.createElement(Lt.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:n,open:!0,scroll:"body"},o.a.createElement(Mt.a,{className:t.closeButton,onClick:n},o.a.createElement(Pt.a,null)),o.a.createElement(k.a,{className:t.title},a),this.props.children)}}]),n}(o.a.Component),Bt=Object(W.a)((function(e){return Object(j.a)({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)}})}))(Wt),Ut=n(47),zt=n.n(Ut),Gt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.lines;return o.a.createElement(it.a,null,o.a.createElement(st.a,null,n.map((function(e,n){return o.a.createElement(mt.a,{key:n},o.a.createElement(pt.a,{className:zt()(t.cell,t.lineNumber),"data-line-number":n+1}),o.a.createElement(pt.a,{className:zt()(t.cell,t.line)},e))}))))}}]),n}(o.a.Component),_t=Object(W.a)((function(e){return Object(j.a)({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})}))(Gt),Ht=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(E.a)(h.a.mark((function e(){var t,n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,n=t.nodeIp,a=t.pid,e.next=4,T(n,a);case 4:r=e.sent,this.setState({result:r.errors,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.clearErrorDialog,a=e.nodeIp,r=this.state,c=r.result,l=r.error;return o.a.createElement(Bt,{handleClose:n,title:"Errors"},null!==l?o.a.createElement(k.a,{color:"error"},l):null===c?o.a.createElement(k.a,{color:"textSecondary"},"Loading..."):Object.entries(c).map((function(e){var n=Object(v.a)(e,2),r=n[0],c=n[1];return o.a.createElement(o.a.Fragment,{key:r},o.a.createElement(k.a,{className:t.header},a," (PID: ",r,")"),c.length>0?c.map((function(e,n){var a=e.message,r=e.timestamp;return o.a.createElement("div",{className:t.error,key:n},o.a.createElement(k.a,{className:t.timestamp},"Error at ",new Date(1e3*r).toLocaleString()),o.a.createElement(_t,{lines:a.trim().split("\n")}))})):o.a.createElement(k.a,{color:"textSecondary"},"No errors found."))})))}}]),n}(o.a.Component),Vt=Object(W.a)((function(e){return Object(j.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},error:{backgroundColor:Object(At.c)(e.palette.error.main,.04),borderLeftColor:e.palette.error.main,borderLeftStyle:"solid",borderLeftWidth:2,marginTop:e.spacing(3),padding:e.spacing(2)},timestamp:{color:e.palette.text.secondary,marginBottom:e.spacing(1)}})}))(Ht),qt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(E.a)(h.a.mark((function e(){var t,n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,n=t.nodeIp,a=t.pid,e.next=4,F(n,a);case 4:r=e.sent,this.setState({result:r.logs,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.clearLogDialog,a=e.nodeIp,r=this.state,c=r.result,l=r.error;return o.a.createElement(Bt,{handleClose:n,title:"Logs"},null!==l?o.a.createElement(k.a,{color:"error"},l):null===c?o.a.createElement(k.a,{color:"textSecondary"},"Loading..."):Object.entries(c).map((function(e){var n=Object(v.a)(e,2),r=n[0],c=n[1];return o.a.createElement(o.a.Fragment,{key:r},o.a.createElement(k.a,{className:t.header},a," (PID: ",r,")"),c.length>0?o.a.createElement("div",{className:t.log},o.a.createElement(_t,{lines:c})):o.a.createElement(k.a,{color:"textSecondary"},"No logs found."))})))}}]),n}(o.a.Component),Jt=Object(W.a)((function(e){return Object(j.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},log:{backgroundColor:Object(At.c)(e.palette.primary.main,.04),borderLeftColor:e.palette.primary.main,borderLeftStyle:"solid",borderLeftWidth:2,padding:e.spacing(2)}})}))(qt),Kt={id:"cpu",ClusterFeatureRenderFn:function(e){var t=e.nodes,n=ee(t.map((function(e){return{weight:e.cpus[0],value:e.cpu}})));return o.a.createElement("div",{style:{minWidth:60}},o.a.createElement(ve,{percent:n,text:"".concat(n.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement("div",{style:{minWidth:60}},o.a.createElement(ve,{percent:t.cpu,text:"".concat(t.cpu.toFixed(1),"%")}))},WorkerFeatureRenderFn:function(e){var t=e.worker;return o.a.createElement("div",{style:{minWidth:60}},o.a.createElement(ve,{percent:t.cpuPercent,text:"".concat(t.cpuPercent.toFixed(1),"%")}))},nodeAccessor:function(e){return e.node.cpu},workerAccessor:function(e){return e.worker.cpuPercent}},Yt={id:"disk",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,c=Object($.a)(n);try{for(c.s();!(t=c.n()).done;){var l=t.value;"/"in l.disk&&(a+=l.disk["/"].used,r+=l.disk["/"].total)}}catch(i){c.e(i)}finally{c.f()}return o.a.createElement(ve,{percent:100*a/r,text:at(a,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(ve,{percent:100*t.disk["/"].used/t.disk["/"].total,text:at(t.disk["/"].used,t.disk["/"].total,"gibibyte",!0)})},WorkerFeatureRenderFn:function(){return o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.disk["/"].used}},Xt=n(2),Qt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=Object(Xt.a)(e,["classes"]);return o.a.createElement("span",Object.assign({className:t.button},n))}}]),n}(o.a.Component),Zt=Object(W.a)((function(e){return Object(j.a)({button:{color:e.palette.primary.main,"&:hover":{cursor:"pointer",textDecoration:"underline"}}})}))(Qt),$t=function(e){var t=e.nodes,n=te(t.map((function(e){var t;return null!==(t=e.errorCount)&&void 0!==t?t:0})));return 0===n?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):o.a.createElement(o.a.Fragment,null,n.toLocaleString()," ",1===n?"error":"errors")},en=function(e){return function(t){var n,a=t.node,r=null!==(n=a.errorCount)&&void 0!==n?n:0;return 0===r?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):o.a.createElement(Zt,{onClick:function(){return e(a.ip,null)}},"View all errors (",r.toLocaleString(),")")}},tn=function(e){var t;return null!==(t=e.node.errorCount)&&void 0!==t?t:0},nn=function(e){return function(t){var n,a=t.node,r=t.worker;return 0!==r.errorCount?o.a.createElement(Zt,{onClick:function(){return e(a.ip,r.pid)}},"View errors (",null===(n=r.errorCount)||void 0===n?void 0:n.toLocaleString(),")"):o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors")}},an=function(e){var t;return null!==(t=e.worker.errorCount)&&void 0!==t?t:0},rn=function(e){return{id:"errors",ClusterFeatureRenderFn:$t,WorkerFeatureRenderFn:nn(e),NodeFeatureRenderFn:en(e),nodeAccessor:tn,workerAccessor:an}},on=Object(ne.a)(k.a)((function(e){return{paddingRight:e.theme.spacing(1)}})),cn=function(e){if(null===e.gpus)return NaN;var t=e.gpus.filter((function(e){return e.utilizationGpu}));return 0===t.length?NaN:te(t.map((function(e){var t;return null!==(t=e.utilizationGpu)&&void 0!==t?t:0})))/t.length},ln=function(e){var t=e.gpu,n=e.slot;return o.a.createElement(z.a,{display:"flex",style:{minWidth:120}},o.a.createElement(me.a,{title:t.name},o.a.createElement(on,{variant:"body1"},"[",n,"]:")),t.utilizationGpu?o.a.createElement(ve,{percent:t.utilizationGpu,text:"".concat(t.utilizationGpu.toFixed(1),"%")}):o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},sn=function(e){var t=e.resourceSlot,n=t.allocation,a=t.slot,r=n>=1&&void 0===a?"0":void 0===a?"?":a.toString();return o.a.createElement(k.a,{variant:"body1"},"[",r,"]: ",n)},un={id:"gpu",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:cn(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:ee(t)}(e.nodes);return o.a.createElement("div",{style:{minWidth:120}},isNaN(t)?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):o.a.createElement(ve,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node,n=void 0!==t.gpus&&0!==t.gpus.length;return o.a.createElement("div",{style:{minWidth:120}},n?t.gpus.map((function(e,t){return o.a.createElement(ln,{gpu:e,slot:t})})):o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},WorkerFeatureRenderFn:function(e){var t,n,a=null===(t=e.worker.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,r=null===a||void 0===a?void 0:a.GPU;return n=void 0===r?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.resourceSlots.sort((function(e,t){return void 0===e.slot&&void 0===t.slot?0:void 0===e.slot?1:void 0===t.slot?-1:e.slot-t.slot})).map((function(e){return o.a.createElement(sn,{resourceSlot:e})})),o.a.createElement("div",{style:{minWidth:60}},n)},nodeAccessor:function(e){var t=e.node;return cn(t)},workerAccessor:function(e){var t;return null!==(t=function(e){var t,n=null===e||void 0===e||null===(t=e.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,a=null===n||void 0===n?void 0:n.GPU;return a&&te(a.resourceSlots.map((function(e){return e.allocation})))}(e.worker))&&void 0!==t?t:0}},mn=function(e){var t=function(e){return e.memoryUsed&&e.memoryTotal?e.memoryUsed/e.memoryTotal:NaN};return 0===e.gpus.map(t).filter((function(e){return!!e})).length?NaN:100*(te(e.gpus.map((function(e){return t(e)})))/e.gpus.length)},dn=function(e){var t=e.gpuName,n=e.slot,a=function(e,t){return"".concat(e," MiB / ").concat(t," MiB")}(e.utilization,e.total);return o.a.createElement(z.a,{display:"flex",style:{minWidth:120}},o.a.createElement(me.a,{title:t},o.a.createElement(on,{variant:"body1"},"[",n,"]: ",a)))},pn={id:"gram",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:mn(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:ee(t)}(e.nodes);return o.a.createElement("div",{style:{minWidth:60}},isNaN(t)?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):o.a.createElement(ve,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node.gpus.map((function(e,t){var n={gpuName:e.name,utilization:e.memoryUsed,total:e.memoryTotal,slot:t};return o.a.createElement(dn,n)}));return o.a.createElement("div",{style:{minWidth:60}},0===t.length?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):o.a.createElement("div",{style:{minWidth:120}},t))},WorkerFeatureRenderFn:function(e){var t=e.worker,n=e.node.gpus.map((function(e,n){var a=e.processes.find((function(e){return e.pid===t.pid}));if(a){var r={gpuName:e.name,total:e.memoryTotal,utilization:a.gpuMemoryUsage,slot:n};return o.a.createElement(dn,r)}})).filter((function(e){return void 0!==e}));return 0===n.length?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):o.a.createElement("div",{style:{minWidth:120}},n)},nodeAccessor:function(e){var t=e.node,n=mn(t);return isNaN(n)?-1:n},workerAccessor:function(e){var t=e.worker,n=e.node;return 0===n.gpus.length?-1:function(e,t){var n=t.gpus.map((function(e){return e.processes})).map((function(t){return t.find((function(t){return t.pid===e.pid}))})).map((function(e){return(null===e||void 0===e?void 0:e.gpuMemoryUsage)||0}));return te(n)}(t,n)}},fn={id:"host",ClusterFeatureRenderFn:function(e){var t=e.nodes;return o.a.createElement(o.a.Fragment,null,"Totals (",t.length.toLocaleString()," ",1===t.length?"host":"hosts",")")},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(o.a.Fragment,null,t.hostname," (",t.ip,")")},WorkerFeatureRenderFn:function(e){var t=e.worker;return o.a.createElement(o.a.Fragment,null,t.cmdline[0].split("::",2)[0]," (PID: ",t.pid,")")},nodeAccessor:function(e){return e.node.hostname}},bn=function(e){var t=e.nodes,n=te(t.map((function(e){var t;return null!==(t=e.logCount)&&void 0!==t?t:0})));return 0===n?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):o.a.createElement(o.a.Fragment,null,n.toLocaleString()," ",1===n?"line":"lines")},gn=function(e){return function(t){var n,a=t.node,r=null!==(n=a.logCount)&&void 0!==n?n:0;return 0===r?o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):o.a.createElement(Zt,{onClick:function(){return e(a.ip,null)}},"View all logs (",r.toLocaleString()," ",1===a.logCount?"line":"lines",")")}},hn=function(e){var t=e.node;return t.logCount?te(Object.values(t.logCount)):0},vn=function(e){return function(t){var n,a=t.worker,r=t.node,c=null!==(n=a.logCount)&&void 0!==n?n:0;return 0!==c?o.a.createElement(Zt,{onClick:function(){return e(r.ip,a.pid)}},"View log (",c.toLocaleString()," ",1===a.logCount?"line":"lines",")"):o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs")}},En=function(e){var t;return null!==(t=e.worker.logCount)&&void 0!==t?t:0},yn=function(e){return{id:"logs",ClusterFeatureRenderFn:bn,WorkerFeatureRenderFn:vn(e),NodeFeatureRenderFn:gn(e),workerAccessor:En,nodeAccessor:hn}},jn={id:"objectStoreMemory",ClusterFeatureRenderFn:function(e){var t=e.nodes,n=te(t.map((function(e){return e.raylet.objectStoreAvailableMemory}))),a=te(t.map((function(e){return e.raylet.objectStoreUsedMemory}))),r=a+n;return o.a.createElement("div",{style:{minWidth:60}},o.a.createElement(ve,{percent:a/r*100,text:at(a,r,"mebibyte",!1)}))},NodeFeatureRenderFn:function(e){var t=e.node,n=t.raylet.objectStoreAvailableMemory,a=t.raylet.objectStoreUsedMemory,r=n+a;if(void 0===a||void 0===n||0===r)return o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");var c=a/r;return o.a.createElement("div",{style:{minWidth:60}},o.a.createElement(ve,{percent:100*c,text:at(a,r,"mebibyte",!1)}))},WorkerFeatureRenderFn:function(){return o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.raylet.objectStoreUsedMemory},workerAccessor:function(){return 0}},kn={id:"ram",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,c=Object($.a)(n);try{for(c.s();!(t=c.n()).done;){var l=t.value;a+=l.mem[0]-l.mem[1],r+=l.mem[0]}}catch(i){c.e(i)}finally{c.f()}return o.a.createElement(ve,{percent:100*a/r,text:at(a,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(ve,{percent:100*(t.mem[0]-t.mem[1])/t.mem[0],text:at(t.mem[0]-t.mem[1],t.mem[0],"gibibyte",!0)})},WorkerFeatureRenderFn:function(e){var t=e.node,n=e.worker;return o.a.createElement(ve,{percent:100*n.memoryInfo.rss/t.mem[0],text:nt(n.memoryInfo.rss,"mebibyte")})},nodeAccessor:function(e){var t=e.node;return 100*(t.mem[0]-t.mem[1])},workerAccessor:function(e){return e.worker.memoryInfo.rss}},On={id:"received",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=Object($.a)(n);try{for(r.s();!(t=r.n()).done;){a+=t.value.net[1]}}catch(c){r.e(c)}finally{r.f()}return o.a.createElement(o.a.Fragment,null,nt(a,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(o.a.Fragment,null,nt(t.net[1],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.net[1]}},Cn={id:"sent",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=Object($.a)(n);try{for(r.s();!(t=r.n()).done;){a+=t.value.net[0]}}catch(c){r.e(c)}finally{r.f()}return o.a.createElement(o.a.Fragment,null,nt(a,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(o.a.Fragment,null,nt(t.net[0],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return o.a.createElement(k.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.net[0]}},xn=function(e){return Date.now()/1e3-e},Sn={id:"uptime",NodeFeatureRenderFn:function(e){var t=e.node;return o.a.createElement(o.a.Fragment,null,rt(xn(t.bootTime)))},WorkerFeatureRenderFn:function(e){var t=e.worker;return o.a.createElement(o.a.Fragment,null,rt(xn(t.createTime)))},nodeAccessor:function(e){var t=e.node;return xn(t.bootTime)},workerAccessor:function(e){var t=e.worker;return xn(t.createTime)}},Nn={id:"workers",ClusterFeatureRenderFn:function(e){var t,n=e.nodes,a=0,r=0,c=Object($.a)(n);try{for(c.s();!(t=c.n()).done;){var l=t.value;a+=l.cpus[0],r+=l.workers.length}}catch(i){c.e(i)}finally{c.f()}return o.a.createElement(o.a.Fragment,null,r.toLocaleString()," ",1===r?"worker":"workers"," / ",a.toLocaleString()," ",1===a?"core":"cores")},NodeFeatureRenderFn:function(e){var t=e.node,n=t.cpus[0],a=t.workers.length;return o.a.createElement(o.a.Fragment,null,a.toLocaleString()," ",1===a?"worker":"workers"," / ",n.toLocaleString()," ",1===n?"core":"cores")},WorkerFeatureRenderFn:function(e){var t=e.worker;return o.a.createElement(o.a.Fragment,null,t.cmdline[0].split("::",2)[1])}},wn=n(94),Tn=n.n(wn),Fn=n(95),Rn=n.n(Fn),In=function(e){var t=e.features,n=e.data,a=n.node,r=n.worker;return o.a.createElement(mt.a,{hover:!0},o.a.createElement(ft,null),t.map((function(e,t){return o.a.createElement(ft,{key:t},o.a.createElement(e,{node:a,worker:r}))})))},An=Object(y.a)((function(e){return Object(j.a)({cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})})),Ln=function(e){var t=e.features,n=e.node,a=e.initialExpanded,c=e.rayletInfo,l=e.workerFeatureData,i=Object(r.useState)(a),s=Object(v.a)(i,2),u=s[0],m=s[1],d=An(),p=t.map((function(e,t){var a=e.NodeFeatureRenderFn;return o.a.createElement(ft,{className:d.cell,key:t},o.a.createElement(a,{node:n}))}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(mt.a,{hover:!0},o.a.createElement(pt.a,{className:zt()(d.cell,d.expandCollapseCell),onClick:function(){return m(!u)}},u?o.a.createElement(Rn.a,{className:d.expandCollapseIcon}):o.a.createElement(Tn.a,{className:d.expandCollapseIcon})),p),u&&o.a.createElement(o.a.Fragment,null,void 0!==c&&o.a.createElement(mt.a,{hover:!0},o.a.createElement(pt.a,{className:d.cell}),o.a.createElement(pt.a,{className:zt()(d.cell,d.extraInfo),colSpan:t.length},c)),l.map((function(e,n){return o.a.createElement(In,{key:n,features:t.map((function(e){return e.WorkerFeatureRenderFn})),data:e})}))))},Mn=n(96),Dn=n.n(Mn),Pn=Object(y.a)((function(e){return Object(j.a)({cell:{borderTopColor:e.palette.divider,borderTopStyle:"solid",borderTopWidth:2,padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},totalIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"}})})),Wn=function(e){var t=e.nodes,n=e.features,a=Pn();return o.a.createElement(mt.a,{hover:!0},o.a.createElement(pt.a,{className:a.cell},o.a.createElement(Dn.a,{className:a.totalIcon})),n.map((function(e,n){return e?o.a.createElement(pt.a,{className:a.cell,key:n},o.a.createElement(e,{nodes:t})):o.a.createElement(ft,{key:n})})))},Bn=function(e,t){var n=e.sort((function(e,t){var n=e.worker,a=t.worker;return"ray::IDLE"===a.cmdline[0]?-1:"ray::IDLE"===n.cmdline[0]?1:n.pid<a.pid?-1:1}));return t?Z(n,t):n},Un=Object(y.a)((function(e){return Object(j.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})})),zn=function(e){var t,n;return null===(t=e.dashboard)||void 0===t||null===(n=t.nodeInfo)||void 0===n?void 0:n.clients.filter((function(e){return"ALIVE"===e.raylet.state}))},Gn=[{id:"host",label:"Host",numeric:!0,sortable:!0},{id:"workers",label:"PID",numeric:!0,sortable:!1},{id:"uptime",label:"Uptime (s)",numeric:!0,sortable:!0},{id:"cpu",label:"CPU",numeric:!1,sortable:!0},{id:"ram",label:"RAM",numeric:!0,sortable:!0},{id:"gpu",label:"GPU",numeric:!0,sortable:!0},{id:"gram",label:"GRAM",numeric:!0,sortable:!0},{id:"objectStoreMemory",label:"Plasma",numeric:!1,sortable:!0},{id:"disk",label:"Disk",numeric:!0,sortable:!0},{id:"sent",label:"Sent",numeric:!0,sortable:!0},{id:"received",label:"Received",numeric:!1,sortable:!0},{id:"logs",label:"Logs",numeric:!1,sortable:!0},{id:"errors",label:"Errors",numeric:!1,sortable:!0}],_n=function(){var e,t,n=Object(r.useState)(null),a=Object(v.a)(n,2),c=a[0],l=a[1],i=Object(r.useState)(null),s=Object(v.a)(i,2),u=s[0],m=s[1],d=Object(r.useState)(!0),f=Object(v.a)(d,2),b=f[0],g=f[1],h=o.a.useState("asc"),E=Object(v.a)(h,2),y=E[0],j=E[1],O=o.a.useState(null),C=Object(v.a)(O,2),x=C[0],S=C[1],N=Un(),w=Object(p.d)(zn);if(!w)return o.a.createElement(k.a,{color:"textSecondary"},"Loading...");var T=te(w.map((function(e){return e.workers.length}))),F=[fn,Nn,Sn,Kt,kn,un,pn,jn,Yt,Cn,On,yn((function(e,t){return l({nodeIp:e,pid:t})})),rn((function(e,t){return m({nodeIp:e,pid:t})}))],R=null===(e=F.find((function(e){return e.id===x})))||void 0===e?void 0:e.nodeAccessor,I=R&&Q(y,R),A=null===(t=F.find((function(e){return e.id===x})))||void 0===t?void 0:t.workerAccessor,L=A&&Q(y,A),M=0!==w.map((function(e){return e.gpus})).filter((function(e){return 0!==e.length})).length,D=function(e){return M||"gpu"!==e.id&&"gram"!==e.id},P=F.filter(D),W=Gn.filter(D),B=b?function(e,t,n,a){return(n?Z(e,n):e).map((function(n){var r=n.workers.map((function(e){return{node:n,worker:e}})),c=Bn(r,t);return o.a.createElement(Ln,{key:n.raylet.nodeId,node:n,workerFeatureData:c,features:a,initialExpanded:e.length<=1})}))}(w,L,I,P):function(e,t,n){var a=n.map((function(e){return e.WorkerFeatureRenderFn})),r=e.flatMap((function(e){return e.workers.map((function(t){return{node:e,worker:t}}))}));return Bn(r,t).map((function(e,t){return o.a.createElement(In,{features:a,data:e,key:"worker-".concat(t)})}))}(w,L,P);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Rt.a,{control:o.a.createElement(It.a,{checked:b,onChange:function(){return g(!b)},color:"primary"}),label:"Group by host"}),o.a.createElement(it.a,{className:N.table},o.a.createElement(gt,{onRequestSort:function(e,t){t===x?j("asc"===y?"desc":"asc"):(S(t),j("asc"))},headerInfo:W,order:y,orderBy:x,firstColumnEmpty:!0}),o.a.createElement(st.a,null,B,o.a.createElement(Wn,{clusterTotalWorkers:T,nodes:w,features:P.map((function(e){return e.ClusterFeatureRenderFn}))}))),null!==c&&o.a.createElement(Jt,{clearLogDialog:function(){return l(null)},nodeIp:c.nodeIp,pid:c.pid}),null!==u&&o.a.createElement(Vt,{clearErrorDialog:function(){return m(null)},nodeIp:u.nodeIp,pid:u.pid}))},Hn=Object(y.a)((function(e){return Object(j.a)({table:{marginTop:e.spacing(1),width:"auto"},cell:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3),paddingRight:e.spacing(3),textAlign:"center","&:last-child":{paddingRight:e.spacing(3)}},key:{color:e.palette.text.secondary}})})),Vn=et.setRayConfig,qn=et.setError,Jn=function(e){return e.dashboard.rayConfig},Kn=function(){var e=Hn(),t=Object(p.d)(Jn),n=Object(p.c)(),a=Object(r.useCallback)(Object(E.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S("/api/ray_config",{});case 3:t=e.sent,n(Vn(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(qn(e.t0.toString()));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[n]),c=Object(r.useRef)(null);if(Object(r.useEffect)((function(){null===c.current&&(a(),c.current=setInterval(a,1e4));return function(){clearInterval(c.current)}}),[a]),null===t)return o.a.createElement(k.a,{color:"textSecondary"},"No Ray configuration detected.");var l=[{key:"Autoscaling mode",value:t.autoscalingMode},{key:"Head node type",value:t.headType},{key:"Worker node type",value:t.workerType},{key:"Min worker nodes",value:t.minWorkers},{key:"Initial worker nodes",value:t.initialWorkers},{key:"Max worker nodes",value:t.maxWorkers},{key:"Idle timeout",value:"".concat(t.idleTimeoutMinutes," ").concat(1===t.idleTimeoutMinutes?"minute":"minutes")}];return o.a.createElement("div",null,o.a.createElement(k.a,null,"Ray cluster configuration:"),o.a.createElement(it.a,{className:e.table},o.a.createElement(ut.a,null,o.a.createElement(mt.a,null,o.a.createElement(pt.a,{className:e.cell},"Setting"),o.a.createElement(pt.a,{className:e.cell},"Value"))),o.a.createElement(st.a,null,l.map((function(t,n){var a=t.key,r=t.value;return o.a.createElement(mt.a,{key:n},o.a.createElement(pt.a,{className:zt()(e.cell,e.key)},a),o.a.createElement(pt.a,{className:e.cell},r))})))))},Yn=n(187),Xn=n(185),Qn=et,Zn=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currentError:"",open:!1},e.handleOpen=function(t){e.setState({open:!0,currentError:t})},e.handleClose=function(){e.setState({open:!1})},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.tuneInfo,r=this.state,c=r.currentError,l=r.open;return null===a||0===Object.keys(a.errors).length?null:o.a.createElement(o.a.Fragment,null,o.a.createElement(it.a,{className:n.table},o.a.createElement(ut.a,null,o.a.createElement(mt.a,null,o.a.createElement(pt.a,{className:n.cell}," Job ID"),o.a.createElement(pt.a,{className:n.cell}," Trial ID "),o.a.createElement(pt.a,{className:n.cell}," Trial Directory "),o.a.createElement(pt.a,{className:n.cell}," Error "))),o.a.createElement(st.a,null,null!==a.errors&&Object.keys(a.errors).map((function(t,r){return o.a.createElement(mt.a,{key:r},o.a.createElement(pt.a,{className:n.cell},a.errors[t].jobId),o.a.createElement(pt.a,{className:n.cell},a.errors[t].trialId),o.a.createElement(pt.a,{className:n.cell},t),o.a.createElement(pt.a,{className:n.cell},o.a.createElement(Xn.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t)}},"Show Error")))})))),l&&o.a.createElement(Bt,{handleClose:this.handleClose,title:"Error Log"},l&&o.a.createElement(_t,{lines:a.errors[c].text.trim().split("\n")})))}}]),n}(o.a.Component),$n=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),Qn)(Object(W.a)((function(e){return Object(j.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})}))(Zn)),ea=n(133),ta=n(186),na=et,aa=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={sortedColumn:void 0,ascending:!0,metricParamColumn:"",metricColumns:[],paramColumns:[],errorTrial:"",open:!1},e.onColumnClick=function(t,n){var a=e.state.ascending;a=t!==e.state.sortedColumn||!a,e.setState({sortedColumn:t,ascending:a}),n&&e.setState({metricParamColumn:n})},e.humanize=function(e){return e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},e.handleOpen=function(t){"number"===typeof t&&(t=t.toString()),e.setState({open:!0,errorTrial:t})},e.handleClose=function(){e.setState({open:!1})},e.sortedCell=function(t,n,a){var r=e.props,c=r.tuneInfo,l=r.classes,i=e.state,s=i.sortedColumn,u=i.ascending,m=i.metricParamColumn,d="asc";if(t!==s||u||(d="desc"),null!==c){var p=function(){return e.onColumnClick(t)};n&&(p=function(){return e.onColumnClick(t,n)}),a||(a=0);var f=!1,b=t+a.toString();return n?(b=n+a.toString(),f=n===m&&s===t):f=t===s,o.a.createElement(pt.a,{className:l.cell,key:b,onClick:p},o.a.createElement(dt.a,{active:f,direction:d}),n?e.humanize(n):e.humanize(t))}},e.sortedTrialRecords=function(){var t=e.props.tuneInfo,n=e.state,a=n.sortedColumn,r=n.ascending,o=n.metricParamColumn;if(null===t||0===Object.keys(t.trialRecords).length)return null;var c=Object.values(t.trialRecords);if(!a)return c;var l=function(e){return e[a]};return"metrics"!==a&&"params"!==a||(l=function(e){return e[a][o]}),a&&(r?c.sort((function(e,t){return l(e)>l(t)?1:-1})):r||c.sort((function(e,t){return l(e)<l(t)?1:-1}))),c},e.handleMetricChoiceChange=function(t){return function(n){var a=e.state.metricColumns;n.target.checked?(a.push(t),e.setState({metricColumns:a})):(a=a.filter((function(e){return e!==t})),e.setState({metricColumns:a}))}},e.metricChoices=function(t){var n=e.state.metricColumns;return o.a.createElement(G.a,null,o.a.createElement(ea.a,{component:"legend"},"Select Metrics "),o.a.createElement(ta.a,null,t.map((function(t){return o.a.createElement(Rt.a,{control:o.a.createElement(It.a,{checked:n.includes(t),onChange:e.handleMetricChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e.handleParamChoiceChange=function(t){return function(n){var a=e.state.paramColumns;n.target.checked?(a.push(t),e.setState({paramColumns:a})):(a=a.filter((function(e){return e!==t})),e.setState({paramColumns:a}))}},e.paramChoices=function(t){var n=e.props.classes,a=e.state.paramColumns;return o.a.createElement(G.a,{className:n.paramChecklist},o.a.createElement(ea.a,{component:"legend"},"Select Parameters "),o.a.createElement(ta.a,null,t.map((function(t){return o.a.createElement(Rt.a,{control:o.a.createElement(It.a,{checked:a.includes(t),onChange:e.handleParamChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.tuneInfo,r=this.state,c=r.metricColumns,l=r.paramColumns,i=r.open,s=r.errorTrial;if(null===a||0===Object.keys(a.trialRecords).length)return null;var u=Object.keys(a.trialRecords)[0],m=a.trialRecords[u].params,d=Object.keys(m).filter((function(e){return"args"!==e})),p=d,f=d.length>3;f&&(0===l.length&&this.setState({paramColumns:d.slice(0,3)}),p=l);var b=Object.keys(a.trialRecords[u].metrics),g=b,h=b.length>3;h&&(0===c.length&&this.setState({metricColumns:b.slice(0,3)}),g=c);var v=this.sortedTrialRecords();return o.a.createElement("div",{className:n.root},o.a.createElement(re.a,{container:!0,spacing:0},(f||h)&&o.a.createElement(re.a,{item:!0,xs:2,className:n.checkboxRoot},f&&this.paramChoices(d),h&&this.metricChoices(b)),o.a.createElement(re.a,{item:!0,xs:f||h?10:12,className:n.table},o.a.createElement(it.a,{stickyHeader:!0},o.a.createElement(ut.a,null,o.a.createElement(mt.a,null,this.sortedCell("trialId"),this.sortedCell("jobId"),this.sortedCell("startTime"),p.map((function(t,n){return e.sortedCell("params",t,n)})),this.sortedCell("status"),g.map((function(t,n){return e.sortedCell("metrics",t,n)})),o.a.createElement(pt.a,{className:n.cell,key:"error"},"Error"))),o.a.createElement(st.a,null,null!==v&&v.map((function(t,a){return o.a.createElement(mt.a,{key:a},o.a.createElement(pt.a,{className:n.cell},t.trialId),o.a.createElement(pt.a,{className:n.cell},t.jobId),o.a.createElement(pt.a,{className:n.cell},t.startTime),p.map((function(e,a){return o.a.createElement(pt.a,{className:n.cell,key:a},"number"===typeof t.params[e]?ot(Number(t.params[e])):t.params[e])})),o.a.createElement(pt.a,{className:n.cell},t.status),t.metrics&&g.map((function(e,a){return o.a.createElement(pt.a,{className:n.cell,key:a},"number"===typeof t.metrics[e]?ot(Number(t.metrics[e])):t.metrics[e])})),o.a.createElement(pt.a,{className:n.cell},"No Error"===t.error?"No Error":o.a.createElement(Xn.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t.trialId)}},"Show Error")))})))))),i&&o.a.createElement(Bt,{handleClose:this.handleClose,title:"Error Log"},i&&o.a.createElement(_t,{lines:a.trialRecords[s].error.trim().split("\n")})))}}]),n}(o.a.Component),ra=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),na)(Object(W.a)((function(e){return Object(j.a)({root:{padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},table:{marginTop:e.spacing(1),height:"700px",overflowY:"auto"},cell:{padding:e.spacing(1),textAlign:"right","&:last-child":{paddingRight:e.spacing(1)}},checkboxRoot:{height:"500px",overflowY:"auto",overflowX:"auto"},paramChecklist:{marginBottom:e.spacing(2)}})}))(aa)),oa=et,ca=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={tensorBoardEnabled:!1,loading:!1},e.handleSubmit=function(){e.setState({loading:!0}),M().then((function(){e.setState({loading:!1})}))},e.tensorBoard=function(){var t=e.props,n=t.classes,a=t.error,r=t.tuneInfo;return o.a.createElement("div",null,"TypeError: Failed to fetch"===a&&o.a.createElement(k.a,{className:n.warning,color:"textSecondary"},'Warning: Tensorboard server closed. View Tensorboard by running "tensorboard --logdir" if not displaying below.'),r&&!r.tensorboard.tensorboardCurrent&&o.a.createElement(k.a,{className:n.warning,color:"textSecondary"},"The below Tensorboard reflects a previously entered log directory. Restart the Ray Dashboard to change the Tensorboard logdir."),o.a.createElement("iframe",{src:"http://localhost:6006/",className:n.board,title:"TensorBoard"}))},e}return Object(s.a)(n,[{key:"enableTensorBoard",value:function(){M(),this.setState({tensorBoardEnabled:!0})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.tuneInfo,a=this.state.loading;if(null!==n){var r=n.tensorboard.tensorboardEnabled;return o.a.createElement("div",{className:t.root},!r&&o.a.createElement("div",null,o.a.createElement(Ve.a,{variant:"outlined",onClick:this.handleSubmit,className:t.warning},"Enable TensorBoard"),a&&o.a.createElement(Ge.a,{className:t.progress,size:25})),r&&this.tensorBoard())}}}]),n}(o.a.Component),la=Object(p.b)((function(e){return{error:e.dashboard.error,tuneInfo:e.dashboard.tuneInfo}}),oa)(Object(W.a)((function(e){return Object(j.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},board:{width:"100%",height:"1000px",border:"none"},warning:{fontSize:"0.8125rem"},progress:{marginLeft:"10px",marginTop:"2px"}})}))(ca)),ia=et,sa=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={tabIndex:0,experiment:"",loading:!1},e.refreshTuneInfo=Object(E.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.props.tuneAvailability||!e.props.tuneAvailability.available){t.next=6;break}return t.next=4,A();case 4:n=t.sent,e.props.setTuneInfo(n);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.props.setError(t.t0.toString());case 11:return t.prev=11,e.timeout=window.setTimeout(e.refreshTuneInfo,1e3),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])}))),e.handleTabChange=function(t,n){e.setState({tabIndex:n})},e.handleExperimentChange=function(t){e.setState({experiment:t.target.value})},e.handleExperimentSubmit=Object(E.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,t.next=4,L(e.state.experiment);case 4:return window.clearTimeout(e.timeout),t.next=7,e.refreshTuneInfo();case 7:e.setState({loading:!1}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.props.setError(t.t0.toString()),e.setState({loading:!1});case 14:case"end":return t.stop()}}),t,null,[[1,10]])}))),e.experimentChoice=function(t){var n=e.props.classes,a=e.state.loading;return o.a.createElement("div",null,t&&o.a.createElement(k.a,{className:n.heading,color:"textPrimary"},"You can use this tab to monitor Tune jobs, their statuses, hyperparameters, and more. For more information, read the documentation"," ",o.a.createElement("a",{href:"https://docs.ray.io/en/master/ray-dashboard.html#tune"},"here"),"."),o.a.createElement("div",null,o.a.createElement(k.a,{className:n.prompt,color:"textSecondary"},"Enter Tune Log Directory Here:"),o.a.createElement(Yn.a,{className:n.input,id:"standard-basic",value:e.state.experiment,onChange:e.handleExperimentChange}),o.a.createElement(Ve.a,{className:n.submit,variant:"outlined",onClick:e.handleExperimentSubmit},"Submit"),a&&o.a.createElement(Ge.a,{className:n.progress,size:25})))},e}return Object(s.a)(n,[{key:"componentWillUnmount",value:function(){var e=Object(E.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.clearTimeout(this.timeout);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.tuneInfo,a=e.tuneAvailability;if(a&&!a.trialsAvailable)return this.experimentChoice(!0);var r=this.state.tabIndex,c=[{label:"Table",component:ra},{label:"TensorBoard",component:la}];null!==n&&Object.keys(n.errors).length>0&&c.push({label:"Errors",component:$n});var l=c[r].component;return o.a.createElement("div",{className:t.root},this.experimentChoice(!1),o.a.createElement(O.a,{className:t.tabs,indicatorColor:"primary",onChange:this.handleTabChange,textColor:"primary",value:r},c.map((function(e){var t=e.label;return o.a.createElement(C.a,{key:t,label:t})}))),o.a.createElement(l,null))}}]),n}(o.a.Component),ua=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo,tuneAvailability:e.dashboard.tuneAvailability}}),ia)(Object(W.a)((function(e){return Object(j.a)({root:{backgroundColor:e.palette.background.paper},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1},heading:{fontsize:"0.9em",marginTop:e.spacing(2)},warning:{fontSize:"1em"},warningIcon:{fontSize:"1.25em",verticalAlign:"text-bottom"},formControl:{margin:e.spacing(1),minWidth:120},submit:{marginLeft:e.spacing(2),fontSize:"0.8125em"},prompt:{fontSize:"1em",marginTop:e.spacing(1)},input:{width:"85%"},progress:{marginLeft:e.spacing(2)}})}))(sa)),ma=et.setNodeInfo,da=et.setTuneAvailability,pa=et.setActorGroups,fa=et.setError,ba=et.setTab,ga=Object(y.a)((function(e){return Object(j.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1}})})),ha=function(e){return e.dashboard.tab},va=function(e){return e.dashboard.tuneAvailability},Ea=[{label:"Machine view",component:_n},{label:"Logical view",component:ze},{label:"Memory",component:Ft},{label:"Ray config",component:Kn},{label:"Tune",component:ua}],ya=function(){var e=Object(p.c)(),t=Object(p.d)(va),n=Object(p.d)(ha),a=ga(),c=Object(r.useCallback)(Object(E.a)(h.a.mark((function t(){var n,a,r,o,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([S("/nodes",{view:"details"}),S("/tune/availability",{}),S("logical/actor_groups",{})]);case 3:n=t.sent,a=Object(v.a)(n,3),r=a[0],o=a[1],c=a[2],e(ma({nodeInfo:r})),e(da(o)),e(pa(c)),e(fa(null)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e(fa(t.t0.toString()));case 17:case"end":return t.stop()}}),t,null,[[0,14]])}))),[e]),l=Object(r.useRef)(null);Object(r.useEffect)((function(){null===l.current&&(c(),l.current=setInterval(c,1e3));return function(){clearInterval(l.current)}}),[c]);var i=Ea.slice();null!==t&&t.available||i.splice(4);var s=i[n].component;return o.a.createElement("div",{className:a.root},o.a.createElement(k.a,{variant:"h5"},"Ray Dashboard"),o.a.createElement(O.a,{className:a.tabs,indicatorColor:"primary",onChange:function(t,n){return e(ba(n))},textColor:"primary",value:n},i.map((function(e){var t=e.label;return o.a.createElement(C.a,{key:t,label:t})}))),o.a.createElement(s,null),o.a.createElement(U,null))},ja=Object(Ze.a)({reducer:{dashboard:tt},devTools:!1}),ka=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return o.a.createElement(p.a,{store:ja},o.a.createElement(f.a,null,o.a.createElement(d.a,null),o.a.createElement(b.a,{component:ya,exact:!0,path:"/"})))}}]),n}(o.a.Component);l.a.render(o.a.createElement(ka,null),document.getElementById("root"))}},[[116,1,2]]]);
//# sourceMappingURL=main.518a6fb3.chunk.js.map